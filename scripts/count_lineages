from waterfall import datamanager
from collections import Counter

dm = datamanager.DataManager.activate(read_only=True)
n_stages = dm.n_stages

lineages = Counter()

provenances = dm.get_provenances()
for p in provenances:
    if p.stage == n_stages - 1:
        lineages[p.lineage] += 1

print(lineages)
print()
print(len(lineages))
print()
print(lineages.most_common())
print()
